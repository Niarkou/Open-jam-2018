pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

--
-- standard pico-8 workflow
--

function _init()
    player = {x = 64, y = 64}
end

function _update()
    update_player()
end

function _draw()
    draw_world()
    draw_player()
end

--
-- play
--

function update_player()
    local new_x = player.x
    local new_y = player.y
    -- apply controls
    if btn(0) then
        new_x -= 1
    elseif btn(1) then
        new_x += 1
    end
    -- test collisions
    if not wall_area(new_x, player.y, 4, 4) then
        player.x = new_x -- new_x is OK!
    end
    if not wall_area(player.x, new_y, 4, 4) then
        player.y = new_y -- new_y is OK!
    end
end

function wall(x,y)
    local m = mget(x/8,y/8)
    if ((x%8<4) and (y%8<4)) return fget(m,0)
    if ((x%8>=4) and (y%8<4)) return fget(m,1)
    if ((x%8<4) and (y%8>=4)) return fget(m,2)
    if ((x%8>=4) and (y%8>=4)) return fget(m,3)
    return true
end

function wall_area(x,y,w,h)
    return wall(x-w,y-h) or wall(x+w,y-h) or
           wall(x-w,y+h) or wall(x+w,y+h)
end

--
-- drawing
--

function draw_world()
    cls(0)
end

function draw_player()
    spr(1, player.x, player.y)
end
__gfx__
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
